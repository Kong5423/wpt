<!doctype html>
<meta charset="utf-8">
<script src="./partitioning-utils.js"></script>
<script>
window.addEventListener("load", () => {
  localStorage.clear();

  const userID = getOrCreateID("userID4");
  const payload = {
    message: "window loaded",
    userID,
  }

  window.opener.postMessage(payload, "*");
});

window.addEventListener("message", e => {
  if (e.data.command == "open about:blank window") {
    window.blankWindow = window.open("about:blank");
    const payload = {
      message: "about:blank frame ID",
      userID: window.blankWindow?.localStorage["userID4"],
    }

    parent.window.opener.postMessage(payload, "*");
  }

  if (e.data.command == "close about:blank window") {
    window.blankWindow.close();
  }
});
</script>
